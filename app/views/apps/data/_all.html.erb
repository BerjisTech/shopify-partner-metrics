<table class="table table-hover">
  <thead>
    <tr>
      <th>App name</th>
      <th>Platform</th>
      <th>Revenue</th>
      <th>Running Data Import</th>
      <th>Platform Data Import</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <% @apps.each do |app| %>
      <% logs = @import_logs.filter{|f| f.app_id == app.id } %>
      <% log_stat = (logs.filter{|f| f.status == 0 }.count/logs.count).to_f * 100 %>
      <tr>
        <td><%= app.app_name %></td>
        <td><%= link_to app.name, platform_path(app.platform_id) %></td>
        <td>$<%= number_with_precision(@metrics.filter{|f| f.app_id == app.id}.first[:net], precision: 2, delimiter: ',') %></td>
        <td>
          <span class="text-success d-flex align-items-center justify-content-start">
            <span class="material-icons small-icons">adjust</span>
            <span class="ps-1">Ok</span>
          </span>
        </td>
        <td>
          <% if log_stat < 15 %>
            <span class="text-success d-flex align-items-center justify-content-start">
              <span class="material-icons small-icons">adjust</span>
              <span class="ps-1">Ok</span>
              <% if log_stat.positive? %>
                <span class="ps-1 fs-6 text-warning">(<%= log_stat %>% failed)</span>
              <% end %>
            </span>
          <% else %>
            <span class="text-danger d-flex align-items-center justify-content-start">
              <span class="material-icons small-icons">error</span>
              <span class="ps-1">Failing</span>
            </span>
          <% end %>
        </td>
        <td><%= link_to 'Show', app %></td>
        <td><%= link_to 'Destroy', app, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
